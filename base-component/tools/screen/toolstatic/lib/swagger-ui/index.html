<!-- HTML for static distribution bundle build -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Swagger UI</title>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/swagger-ui/4.1.3/swagger-ui.min.css"
        integrity="sha512-5Qqi9k+ey4yJCfC/8NemvXAcL9PMUE2ROvmIZ1TXd2sO0KXXZyykItptL710pH2qURIhzeqeidjZIDVtt3sHDA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
  <style>
    html { box-sizing: border-box; overflow: -moz-scrollbars-vertical; overflow-y: scroll; }
    *, *:before, *:after { box-sizing: inherit; }
    body { margin:0; background: #fafafa; }
  </style>
</head>

<body>
  <div id="swagger-ui"></div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/swagger-ui/4.1.3/swagger-ui-bundle.min.js" charset="UTF-8"
          integrity="sha512-yNSFkZpMlHmyfyHN1cNSq7+jguocLrAndVKs0bWHvBiH6gJNmJ89E1x270xH6Or3aXtgBgs+IJ8HvBMIPpPIzw=="
          crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/swagger-ui/4.1.3/swagger-ui-standalone-preset.min.js" charset="UTF-8"
          integrity="sha512-Fwq7/1OWwDxtojfgy3CiqifPDeD8MKhFSBV9oxDe2M4NJMpWcr+1Grd4Q8ZC8uXa9NjfmC4+cEn+utwqlkL/UQ=="
          crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script>
    // JWT token management
    let jwtToken = localStorage.getItem('swagger_jwt_token') || '';
    
    window.onload = function() {
      var url = window.location.search.match(/url=([^&]+)/);
      if (url && url.length > 1) {
        url = decodeURIComponent(url[1]);
      } else {
        url = "http://localhost:8080/rest/service.swagger/moqui";
      }
      
      // Begin Swagger UI call region
      const ui = SwaggerUIBundle({
        url: url, 
        dom_id: '#swagger-ui',
        deepLinking: true,
        presets: [ SwaggerUIBundle.presets.apis, SwaggerUIStandalonePreset ],
        plugins: [ SwaggerUIBundle.plugins.DownloadUrl ],
        layout: "StandaloneLayout",
        requestInterceptor: function(request) {
          // Add JWT token to Authorization header if available
          if (jwtToken) {
            request.headers['Authorization'] = 'Bearer ' + jwtToken;
          }
          return request;
        },
        onComplete: function() {
          // Add custom JWT authorization to the security definitions
          if (ui.spec().securityDefinitions) {
            ui.spec().securityDefinitions.jwtAuth = {
              type: 'apiKey',
              name: 'Authorization',
              in: 'header',
              description: 'JWT Token (format: Bearer <token>) - Enter your JWT token below:'
            };
          }
        }
      });
      
      // Expose UI instance for debugging
      window.ui = ui;
    };
    
    // Function to set JWT token
    function setJwtToken(token) {
      jwtToken = token.trim();
      if (jwtToken) {
        localStorage.setItem('swagger_jwt_token', jwtToken);
      }
    }
    
    // Function to clear JWT token
    function clearJwtToken() {
      jwtToken = '';
      localStorage.removeItem('swagger_jwt_token');
    }
  </script>
</body>
</html>